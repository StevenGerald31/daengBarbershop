<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daeng Barbershop</title>
    <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"
    ></script>

    <!-- Jquery -->
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>

    <!-- bootstrap icon -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="/stylesheets/dashboardServer.css" />
  </head>

  <body>
    <div class="wrapper">
      <aside id="sidebar" class="expand">
        <div class="d-flex justify-content-center">
          <div class="sidebar-logo">
            <img src="/image/logoFIX1.png" />
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="sidebar-judul">
            <h4 class="text-white">Halo, Server</h4>
          </div>
        </div>
        <ul class="sidebar-nav">
          <li class="sidebar-item">
            <a href="#dashboard" class="sidebar-link">
              <h5 class="fw-bold">
                <span>Dashboard</span>
              </h5>
            </a>
          </li>
          <li class="sidebar-item">
            <a href="#data-pelanggan" class="sidebar-link">
              <h5 class="fw-bold">
                <span>Data Pelanggan</span>
              </h5>
            </a>
          </li>
          <li class="sidebar-item">
            <a href="#booking" class="sidebar-link">
              <h5 class="fw-bold">
                <span>Booking</span>
              </h5>
            </a>
          </li>

          <li class="sidebar-item">
            <a href="#daftarProduk" class="sidebar-link">
              <h5 class="fw-bold">
                <span>Produk</span>
              </h5>
            </a>
          </li>
          <li class="sidebar-item">
            <a href="#pembelian-produk" class="sidebar-link">
              <h5 class="fw-bold">
                <span>Pembelian Produk</span>
              </h5>
            </a>
          </li>
        </ul>
        <div class="sidebar-footer">
          <a href="#" class="sidebar-link">
            <i class="lni lni-exit"></i>
            <span>Logout</span>
          </a>
        </div>
      </aside>

      <!-- Main Content Start -->
      <div class="main container-fluid p-3">
        <!-- Dashboard Start -->
        <div id="dashboard">
          <div class="container-fluid">
            <div class="row pt-5">
              <div class="d-flex justify-content-center">
                <h1 class="fw-bold">Daeng Barbershop</h1>
              </div>
            </div>
            <!-- Card -->
            <div class="content-wrap pt-3">
              <div class="content">
                <section
                  class="info-boxes d-flex align-items-center justify-content-center"
                >
                  <div class="info-box">
                    <div class="box-icon">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                      >
                        <path
                          d="M21 20V4a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1zm-2-1H5V5h14v14z"
                        />
                        <path
                          d="M10.381 12.309l3.172 1.586a1 1 0 0 0 1.305-.38l3-5-1.715-1.029-2.523 4.206-3.172-1.586a1.002 1.002 0 0 0-1.305.38l-3 5 1.715 1.029 2.523-4.206z"
                        />
                      </svg>
                    </div>
                    <div class="box-content">
                      <span class="big text-center" id="jlhPelanggan"> </span>
                      Pelanggan
                    </div>
                  </div>

                  <div class="info-box">
                    <div class="box-icon">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                      >
                        <path
                          d="M3,21c0,0.553,0.448,1,1,1h16c0.553,0,1-0.447,1-1v-1c0-3.714-2.261-6.907-5.478-8.281C16.729,10.709,17.5,9.193,17.5,7.5 C17.5,4.468,15.032,2,12,2C8.967,2,6.5,4.468,6.5,7.5c0,1.693,0.771,3.209,1.978,4.219C5.261,13.093,3,16.287,3,20V21z M8.5,7.5 C8.5,5.57,10.07,4,12,4s3.5,1.57,3.5,3.5S13.93,11,12,11S8.5,9.43,8.5,7.5z M12,13c3.859,0,7,3.141,7,7H5C5,16.141,8.14,13,12,13z"
                        />
                      </svg>
                    </div>
                    <div class="box-content">
                      <span class="big text-center" id="jlhVoucher"> </span>
                      Voucher
                    </div>
                  </div>
                </section>
              </div>
            </div>
          </div>
        </div>
        <!-- Dashboard End -->

        <!-- DAta Pelanggan Start -->
        <div id="data-pelanggan">
          <div class="row pt-3">
            <div class="d-flex justify-content-center">
              <h1 class="fw-bold">Data Pelanggan</h1>
            </div>
          </div>
          <div class="row m-3 table-pelanggan">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Nama</th>
                  <th scope="col">No Telp</th>
                  <th scope="col">Jenis Kelamin</th>
                  <th scope="col">Alamat</th>
                  <th scope="col">Point</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody>
                <!-- Rows of data will go here -->
              </tbody>
            </table>
          </div>
        </div>
        <!-- DAta Pelanggan End -->

        <!-- Booking Section Start -->
        <div id="booking">
          <div class="row judul pt-4">
            <div class="d-flex justify-content-start">
              <h3 class="fw-bold">Daftar Booking</h3>
            </div>
          </div>
          <div class="request-container"></div>
          <div class="row judul pt-4">
            <div class="d-flex justify-content-start">
              <h3 class="fw-bold">Daftar Reserved</h3>
            </div>
          </div>
          <div class="reserved-container"></div>
        </div>
        <!-- Booking Section End -->

        <!-- Daftar Stok Produk Start -->
        <div id="daftarProduk">
          <!-- Judul Start -->
          <div class="row judul-produk m-3">
            <div class="d-flex justify-content-center">
              <h2 class="fw-bold">Daftar Stok Produk</h2>
            </div>
          </div>
          <!-- Judul End -->

          <!-- Form Cari Start -->
          <div class="row pencarian m-2 justify-content-center m-3">
            <div class="col-4">
              <form class="d-flex">
                <input
                  class="form-control me-2"
                  type="search"
                  placeholder="Cari Produk"
                  aria-label="Cari"
                />
                <button class="btn btn-outline-success" type="submit">
                  Cari
                </button>
              </form>
            </div>
            <button
              class="btn btn-success"
              type="submit"
              style="max-width: 100px"
              data-bs-toggle="modal"
              data-bs-target="#exampleModal"
            >
              Tambah Jenis
            </button>
          </div>
          <!-- Modal -->
          <div
            class="modal fade"
            id="exampleModal"
            tabindex="-1"
            aria-labelledby="exampleModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="exampleModalLabel">
                    Tambah Jenis Produk
                  </h1>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body">
                  <form id="tambahJenisProdukForm">
                    <div class="mb-3">
                      <label for="jenisproduk" class="form-label"
                        >Jenis Produk</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="jenisproduk"
                        name="jenisproduk"
                        required
                      />
                    </div>
                    <div class="mb-3">
                      <label for="nama" class="form-label">Nama</label>
                      <input
                        type="text"
                        class="form-control"
                        id="nama"
                        name="nama"
                        required
                      />
                    </div>
                    <div class="mb-3">
                      <label for="deskripsi" class="form-label"
                        >Deskripsi</label
                      >
                      <textarea
                        class="form-control"
                        id="deskripsi"
                        name="deskripsi"
                        rows="3"
                        required
                      ></textarea>
                    </div>
                    <div class="mb-3">
                      <label for="harga" class="form-label">Harga</label>
                      <input
                        type="number"
                        class="form-control"
                        id="harga"
                        name="harga"
                        required
                      />
                    </div>
                    <!-- <div class="mb-3">
                      <label for="gambar" class="form-label">Gambar</label>
                      <input
                        type="file"
                        class="form-control"
                        id="gambar"
                        name="gambar"
                        accept="image/*"
                        required
                      />
                    </div> -->
                    <div class="mb-3">
                      <label for="stok" class="form-label">Jumlah Stok</label>
                      <input
                        type="number"
                        class="form-control"
                        id="stok"
                        name="stok"
                        required
                      />
                    </div>
                  </form>
                </div>
                <div class="modal-footer">
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                  >
                    Close
                  </button>
                  <button
                    type="button"
                    class="btn btn-primary"
                    id="saveChangesButton"
                  >
                    Save changes
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Form Cari End -->

          <!-- <div class="row daftar-produk m-2 d-flex justify-content-around">
            <div class="row card-snack">
              <div class="judul d-flex justify-content-center">
                <h3 class="fw-bold">Snack</h3>
              </div>

              <div class="card col-3 m-2">
                <div
                  class="card-img d-flex justify-content-center align-items-center m-1"
                >
                  <img
                    src="/image/minyak-rambut.png"
                    class="card-img-top"
                    alt="Nama Produk"
                  />
                </div>
                <div class="card-body">
                  <h6 class="card-title text-center fw-bold">Nama Produk</h6>
                  <p class="card-text text-center">Rp50.000</p>
                  <div class="d-flex justify-content-center">
                    <button type="button" class="btn btn-success m-1">
                      <i class="bi bi-pencil"></i>
                    </button>
                    <button type="button" class="btn btn-danger m-1">
                      <i class="bi bi-trash3"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="card col-3 m-2">
                <div
                  class="card-img d-flex justify-content-center align-items-center m-1"
                >
                  <img
                    src="/image/minyak-rambut.png"
                    class="card-img-top"
                    alt="Nama Produk"
                  />
                </div>
                <div class="card-body">
                  <h6 class="card-title text-center fw-bold">Nama Produk</h6>
                  <p class="card-text text-center">Rp50.000</p>
                  <div class="d-flex justify-content-center">
                    <button type="button" class="btn btn-success m-1">
                      <i class="bi bi-pencil"></i>
                    </button>
                    <button type="button" class="btn btn-danger m-1">
                      <i class="bi bi-trash3"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="row card-barang">
              <div class="judul d-flex justify-content-center">
                <h3 class="fw-bold">Barang</h3>
              </div>
              <div class="col-3 mt-3">
                <div class="card">
                  <div
                    class="card-img d-flex justify-content-center align-items-center m-1"
                  >
                    <img
                      src="/image/minyak-rambut.png"
                      class="card-img-top"
                      alt="Nama Produk"
                    />
                  </div>
                  <div class="card-body">
                    <h6 class="card-title text-center fw-bold">Nama Produk</h6>
                    <p class="card-text text-center">Rp50.000</p>
                    <div class="d-flex justify-content-center">
                      <button type="button" class="btn btn-success m-1">
                        <i class="bi bi-pencil"></i>
                      </button>
                      <button type="button" class="btn btn-danger m-1">
                        <i class="bi bi-trash3"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div> -->

          <div class="container" style="padding: 20px">
            <div class="row daftar-produk m-2 d-flex justify-content-around">
              <div class="judul d-flex justify-content-center">
                <h3 class="fw-bold">All Produk</h3>
              </div>
              <div
                class="card-produk-container d-flex flex-wrap justify-content-around"
                style="
                  display: flex;
                  flex-wrap: wrap;
                  justify-content: space-around;
                "
              ></div>
            </div>
            <div
              class="modal fade"
              id="updateStockModal"
              tabindex="-1"
              aria-labelledby="updateStockModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5" id="updateStockModalLabel">
                      Update Stok Produk
                    </h1>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <form id="updateStockForm">
                      <div class="mb-3">
                        <label for="stock" class="form-label"
                          >Jumlah Stok Baru</label
                        >
                        <input
                          type="number"
                          class="form-control"
                          id="stock"
                          name="stock"
                          required
                        />
                      </div>
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Close
                    </button>
                    <button
                      type="button"
                      class="btn btn-primary"
                      id="saveStockButton"
                    >
                      Save changes
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- DAftar Stok Produk End -->
        </div>

        <!-- Pembelian Produk Start -->
        <div id="pembelian-produk">
          <div class="row">
            <!-- daftar produk -->
            <div class="col-8">
              <!-- Form Cari Start -->
              <div class="row pencarian m-2 justify-content-center m-3">
                <div class="col-4">
                  <form class="d-flex">
                    <input
                      class="form-control me-2"
                      type="search"
                      placeholder="Cari Produk"
                      aria-label="Cari"
                    />
                    <button class="btn btn-outline-success" type="submit">
                      Cari
                    </button>
                  </form>
                </div>
              </div>
              <!-- Form Cari End -->
              <div class="container" style="padding: 20px">
                <div
                  class="row daftar-produk m-2 d-flex justify-content-around"
                >
                  <div class="judul d-flex justify-content-center">
                    <h3 class="fw-bold">All Produk</h3>
                  </div>
                  <div
                    class="card-produk-pembelian d-flex flex-wrap justify-content-around"
                    style="
                      display: flex;
                      flex-wrap: wrap;
                      justify-content: space-around;
                    "
                  ></div>
                </div>
              </div>
            </div>
            <!-- Daftar Produk End -->

            <!-- Daftar Pesanan Start -->
            <div class="col-4 daftar-pembelian">
              <div class="row judul m-2">
                <h4
                  class="fw-bold text-center text-white"
                  style="border-bottom: 3px solid #000"
                >
                  Daftar Pembelian
                </h4>
              </div>
              <div class="row mt-2">
                <div class="col-12">
                  <div class="card">
                    <div class="row g-0">
                      <!-- <div class="col-md-2 d-flex align-items-center m-1">
                        <img
                          src="/image/minyak-rambut.png"
                          class="img-fluid rounded-start"
                          alt="Nama Produk"
                          style="width: 100%; height: auto"
                        />
                      </div> -->
                      <div class="col-md-5">
                        <div class="card-body">
                          <p class="card-title" style="font-size: 1em">
                            Nama Produk
                          </p>
                          <p class="card-text" style="font-size: 0.8em">
                            Rp50.000
                          </p>
                        </div>
                      </div>
                      <div
                        class="col-md-6 d-flex align-items-center justify-content-center"
                      >
                        <button class="btn btn-outline-secondary">-</button>
                        <span class="mx-3">1</span>
                        <button class="btn btn-outline-secondary">+</button>

                        <button
                          type="button"
                          class="btn btn-danger btn-sm ms-3"
                        >
                          hapus
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-2">
                <div class="col-12">
                  <div class="card">
                    <div class="row g-0">
                      <!-- <div class="col-md-2 d-flex align-items-center m-1">
                        <img
                          src="/image/minyak-rambut.png"
                          class="img-fluid rounded-start"
                          alt="Nama Produk"
                          style="width: 100%; height: auto"
                        />
                      </div> -->
                      <div class="col-md-5">
                        <div class="card-body">
                          <p class="card-title" style="font-size: 1em">
                            Nama Produk
                          </p>
                          <p class="card-text" style="font-size: 0.8em">
                            Rp50.000
                          </p>
                        </div>
                      </div>
                      <div
                        class="col-md-6 d-flex align-items-center justify-content-center"
                      >
                        <button class="btn btn-outline-secondary">-</button>
                        <span class="mx-3">1</span>
                        <button class="btn btn-outline-secondary">+</button>

                        <button
                          type="button"
                          class="btn btn-danger btn-sm ms-3"
                        >
                          hapus
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-2">
                <div class="col-12">
                  <div class="card">
                    <div class="row g-0">
                      <!-- <div class="col-md-2 d-flex align-items-center m-1">
                        <img
                          src="/image/minyak-rambut.png"
                          class="img-fluid rounded-start"
                          alt="Nama Produk"
                          style="width: 100%; height: auto"
                        />
                      </div> -->
                      <div class="col-md-5">
                        <div class="card-body">
                          <p class="card-title" style="font-size: 1em">
                            Nama Produk
                          </p>
                          <p class="card-text" style="font-size: 0.8em">
                            Rp50.000
                          </p>
                        </div>
                      </div>
                      <div
                        class="col-md-6 d-flex align-items-center justify-content-center"
                      >
                        <button class="btn btn-outline-secondary">-</button>
                        <span class="mx-3">1</span>
                        <button class="btn btn-outline-secondary">+</button>

                        <button
                          type="button"
                          class="btn btn-danger btn-sm ms-3"
                        >
                          hapus
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-2">
                <div class="col-12">
                  <div class="card">
                    <div class="row g-0">
                      <!-- <div class="col-md-2 d-flex align-items-center m-1">
                        <img
                          src="/image/minyak-rambut.png"
                          class="img-fluid rounded-start"
                          alt="Nama Produk"
                          style="width: 100%; height: auto"
                        />
                      </div> -->
                      <div class="col-md-5">
                        <div class="card-body">
                          <p class="card-title" style="font-size: 1em">
                            Nama Produk
                          </p>
                          <p class="card-text" style="font-size: 0.8em">
                            Rp50.000
                          </p>
                        </div>
                      </div>
                      <div
                        class="col-md-6 d-flex align-items-center justify-content-center"
                      >
                        <button class="btn btn-outline-secondary">-</button>
                        <span class="mx-3">1</span>
                        <button class="btn btn-outline-secondary">+</button>

                        <button
                          type="button"
                          class="btn btn-danger btn-sm ms-3"
                        >
                          hapus
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- total pembelian -->
              <div
                class="row mt-2"
                style="border-top: 3px solid #000; /* Mengatur border atas */"
              >
                <div class="col-12">
                  <div class="card total-pembelian">
                    <div class="row g-0">
                      <!-- <div class="col-md-2 d-flex align-items-center m-1">
                        <img
                          src="/image/minyak-rambut.png"
                          class="img-fluid rounded-start"
                          alt="Nama Produk"
                          style="width: 100%; height: auto"
                        />
                      </div> -->
                      <div class="col-md-5">
                        <div class="card-body">
                          <p class="card-title" style="font-size: 1em">
                            4 Items
                          </p>
                          <p class="card-text fw-bold" style="font-size: 0.8em">
                            Total : Rp200.000
                          </p>
                        </div>
                      </div>
                      <div
                        class="col-md-6 d-flex align-items-center justify-content-center"
                      >
                        <button class="btn btn-outline-secondary">-</button>
                        <span class="mx-3">1</span>
                        <button class="btn btn-outline-secondary">+</button>

                        <button
                          type="button"
                          class="btn btn-success btn-sm ms-3"
                        >
                          Order
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Daftar Pesanan End -->
          </div>
        </div>
      </div>
    </div>

    <script>
      // Dapatkan semua link sidebar
      const sidebarLinks = document.querySelectorAll(".sidebar-link");

      // Dapatkan semua konten tab
      const tabs = document.querySelectorAll(".main > div");

      sidebarLinks.forEach((link) => {
        link.addEventListener("click", function (e) {
          e.preventDefault();

          // Sembunyikan semua tab
          tabs.forEach((tab) => {
            tab.style.display = "none";
          });

          // Tampilkan tab yang sesuai
          const targetTab = document.querySelector(this.getAttribute("href"));
          if (targetTab) {
            targetTab.style.display = "block";
          }
        });
      });

      window.onload = function () {
        // Sembunyikan semua tab
        tabs.forEach((tab) => {
          tab.style.display = "none";
        });

        // Tampilkan tab profile
        const profileTab = document.querySelector("#dashboard");
        if (profileTab) {
          profileTab.style.display = "block";
        }
      };

      // ---------------script kebutuhan data--------------------

      // Data Pelanggan
      fetch("http://localhost:3000/web/pelanggan/:lokasi", {
        method: "GET",
      })
        .then((response) => response.json())
        .then((data) => {
          console.log("Data Pelanggan: ", data);

          const tableBody = document.querySelector(".table-pelanggan tbody");
          tableBody.innerHTML = ""; // clear existing rows

          data.forEach((item) => {
            point = item.point;
            if (point == null) {
              point = 0;
            }

            const row = `
              <tr>
                <td>${item.name}</td>
                <td>${item.no_telp}</td>
                <td>${item.jenis_kelamin}</td>
                <td>${item.alamat}</td>
                <td>${point}</td>
                <td>
                  <a href=""><i class="fas fa-edit"></i></a>
                  <a href=""><i class="fas fa-trash"></i></a>
                </td>
              </tr>
            `;

            tableBody.innerHTML += row;
          });
        });

      // Data Booking
      fetch("http://localhost:3000/web/request/:lokasi", {
        method: "GET",
      })
        .then((response) => response.json())
        .then((data) => {
          // Ambil elemen tempat untuk meletakkan kartu booking
          const requestContainer = document.querySelector(".request-container");
          if (data.length >= 1) {
            console.log("Data Request: ", data);

            // Iterasi melalui setiap data booking
            data.forEach((request) => {
              // Buat elemen div untuk row daftar-request
              const requestDiv = document.createElement("div");
              requestDiv.classList.add("row", "daftar-request", "mt-2");

              // Buat kolom pertama (Id Pelanggan dan Nama)
              const col1 = document.createElement("div");
              col1.classList.add("col-md-4");
              const info1 = document.createElement("div");
              info1.classList.add("info");
              const idPelanggan = document.createElement("div");
              idPelanggan.textContent = `Id Pelanggan: ${request.id_user}`;
              const namaPelanggan = document.createElement("div");
              namaPelanggan.textContent = request.nama_pelanggan;
              info1.appendChild(idPelanggan);
              info1.appendChild(namaPelanggan);
              col1.appendChild(info1);

              // Buat kolom kedua (Waktu)
              const col2 = document.createElement("div");
              col2.classList.add("col-md-4");
              const info2 = document.createElement("div");
              info2.classList.add("info");
              const waktuLabel = document.createElement("div");
              waktuLabel.textContent = "Waktu:";
              const tanggal = document.createElement("div");
              tanggal.textContent = request.tanggal;
              const jam = document.createElement("div");
              jam.textContent = request.tanggal_booking;
              info2.appendChild(waktuLabel);
              info2.appendChild(tanggal);
              info2.appendChild(jam);
              col2.appendChild(info2);

              // Buat kolom ketiga (Tombol Confirm dan Cancel)
              const col3 = document.createElement("div");
              col3.classList.add(
                "col-md-4",
                "d-flex",
                "justify-content-center"
              );
              const buttonsDiv = document.createElement("div");
              buttonsDiv.classList.add("buttons");
              const confirmButton = document.createElement("button");
              confirmButton.classList.add("button", "confirm");
              confirmButton.textContent = "Confirm";
              const cancelButton = document.createElement("button");
              cancelButton.classList.add("button", "cancel");
              cancelButton.textContent = "Cancel";
              buttonsDiv.appendChild(confirmButton);
              buttonsDiv.appendChild(cancelButton);
              col3.appendChild(buttonsDiv);

              // Add event listener for confirm button
              confirmButton.addEventListener("click", () =>
                confirmRequest(request.id_booking)
              );
              cancelButton.addEventListener("click", () =>
                cancelBooking(request.id_booking)
              );

              // Masukkan kolom-kolom ke dalam row daftar-request
              requestDiv.appendChild(col1);
              requestDiv.appendChild(col2);
              requestDiv.appendChild(col3);

              // Masukkan row daftar-request ke dalam container request
              requestContainer.appendChild(requestDiv);
            });
          } else {
            const noDataText = document.createElement("h4");
            noDataText.textContent = "Data request booking belum tersedia";
            requestContainer.appendChild(noDataText);
          }
        });

      // Data Reserved
      fetch("http://localhost:3000/web/reserved/:lokasi", {
        method: "GET",
      })
        .then((response) => response.json())
        .then((data) => {
          console.log("data: ", data.length);
          // Ambil elemen tempat meletakkan kartu reserved
          const reservedContainer = document.querySelector(
            ".reserved-container"
          );

          if (data.length >= 1) {
            console.log("Data Reserved: ", data);

            // Iterasi melalui setiap data reserved
            data.forEach((reserved) => {
              // Buat elemen div untuk row daftar-reserved
              const reservedDiv = document.createElement("div");
              reservedDiv.classList.add("row", "daftar-reserved", "mt-2");

              // Buat kolom pertama (Id Pelanggan dan Nama)
              const col1 = document.createElement("div");
              col1.classList.add("col-md-4");
              const info1 = document.createElement("div");
              info1.classList.add("info");
              const idPelanggan = document.createElement("div");
              idPelanggan.textContent = `Id Pelanggan: ${reserved.id_user}`;
              const namaPelanggan = document.createElement("div");
              namaPelanggan.textContent = reserved.nama_pelanggan;
              info1.appendChild(idPelanggan);
              info1.appendChild(namaPelanggan);
              col1.appendChild(info1);

              // Buat kolom kedua (Waktu)
              const col2 = document.createElement("div");
              col2.classList.add("col-md-4");
              const info2 = document.createElement("div");
              info2.classList.add("info");
              const waktuLabel = document.createElement("div");
              waktuLabel.textContent = "Waktu:";
              const tanggal = document.createElement("div");
              tanggal.textContent = reserved.tanggal;
              const jam = document.createElement("div");
              jam.textContent = reserved.tanggal_booking;
              info2.appendChild(waktuLabel);
              info2.appendChild(tanggal);
              info2.appendChild(jam);
              col2.appendChild(info2);

              // Buat kolom ketiga (Tombol Confirm dan Cancel)
              const col3 = document.createElement("div");
              col3.classList.add(
                "col-md-4",
                "d-flex",
                "justify-content-center"
              );
              const buttonsDiv = document.createElement("div");
              buttonsDiv.classList.add("buttons");
              const confirmButton = document.createElement("button");
              confirmButton.classList.add("button", "confirm");
              confirmButton.textContent = "Selesai";

              buttonsDiv.appendChild(confirmButton);
              col3.appendChild(buttonsDiv);

              // Add event listener for confirm button
              confirmButton.addEventListener("click", () =>
                finishBooking(reserved.id_booking)
              );

              // Masukkan kolom-kolom ke dalam row daftar-reserved
              reservedDiv.appendChild(col1);
              reservedDiv.appendChild(col2);
              reservedDiv.appendChild(col3);

              // Masukkan row daftar-reserved ke dalam container reserved
              reservedContainer.appendChild(reservedDiv);
            });
          } else {
            const noDataText = document.createElement("h4");
            noDataText.textContent = "Data reserved booking belum tersedia";
            reservedContainer.appendChild(noDataText);
          }
        });

      // Function to confirm booking
      const finishBooking = (bookingId) => {
        // Log the bookingId to the console
        console.log("Confirming booking with ID:", bookingId);

        fetch(`http://localhost:3000/web/booking/finish/${bookingId}`, {
          method: "PUT",
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            return response.json();
          })
          .then((data) => {
            if (data.message) {
              alert(data.message);
            }
            if (data.finish) {
              console.log("Booking Confirmed: ", data.finish);
              // Optionally update the UI to reflect the booking confirmation

              // Reload the page after confirming booking
              window.location.reload();
            }
          })
          .catch((error) => {
            console.error("Error confirming booking: ", error);
            alert("An error occurred while confirming the booking");
          });
      };

      // Function to confirm booking
      const confirmRequest = (bookingId) => {
        // Log the bookingId to the console
        console.log("Confirming booking with ID:", bookingId);

        fetch(`http://localhost:3000/web/booking/confirm/${bookingId}`, {
          method: "PUT",
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            return response.json();
          })
          .then((data) => {
            if (data.message) {
              alert(data.message);
            }
            if (data.booking) {
              console.log("Booking Confirmed: ", data.booking);
              // Optionally update the UI to reflect the booking confirmation

              // Reload the page after confirming booking
              window.location.reload();
            }
          })
          .catch((error) => {
            console.error("Error confirming booking: ", error);
            alert("An error occurred while confirming the booking");
          });
      };

      // Function to confirm booking
      const cancelBooking = (bookingId) => {
        // Log the bookingId to the console
        console.log("Confirming booking with ID:", bookingId);

        fetch(`http://localhost:3000/web/booking/cancel/${bookingId}`, {
          method: "PUT",
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            return response.json();
          })
          .then((data) => {
            if (data.message) {
              alert(data.message);
            }
            if (data.cancel) {
              console.log("cancel Confirmed: ", data.cancel);
              // Optionally update the UI to reflect the booking confirmation

              // Reload the page after confirming booking
              window.location.reload();
            }
          })
          .catch((error) => {
            console.error("Error confirming booking: ", error);
            alert("An error occurred while confirming the booking");
          });
      };

      // daftar stok produk
      function loadProduk() {
        fetch("http://localhost:3000/web/allDataProduk", {
          method: "GET",
        })
          .then((response) => response.json())
          .then((data) => {
            console.log("produk: ", data);

            const daftarProduk = document.querySelector(
              ".card-produk-container"
            );
            daftarProduk.innerHTML = ""; // clear existing cards

            // buat card untuk produk snack
            data.forEach((item) => {
              const harga = item.harga;
              const formattedHarga = `Rp${harga.toLocaleString("id-ID")}`;
              const card = document.createElement("div");
              card.className = "card col-3 m-2";
              card.innerHTML = `
            <div
                    class="card-img d-flex justify-content-center align-items-center m-1"
                  >
                    <img
                      src="/image/minyak-rambut.png"
                      class="card-img-top"
                      alt="Nama Produk"
                    />
                  </div>
                  <div class="card-body">
                    <h6 class="card-title text-center fw-bold">${item.nama_produk}</h6>
                    <p class="card-text text-center">${formattedHarga}</p>
                    <p class="card-text text-center">Stok: ${item.stok}</p>
                    <div class="d-flex justify-content-center">
                      <button type="button" class=" update-stok btn btn-success m-1" data-bs-toggle="modal" data-bs-target="#updateStockModal" data-id="${item.id_produk}">
                        <i class="bi bi-pencil"></i>
                      </button>
                      <button type="button" class="btn btn-danger m-1">
                        <i class="bi bi-trash3"></i>
                      </button>
                    </div>
                  </div>
            `;

              daftarProduk.append(card);
            });
          });
      }

      // Initial load
      loadProduk();

      // daftar stok produk untuk pembelian
      fetch("http://localhost:3000/web/allDataProduk", {
        method: "GET",
      })
        .then((response) => response.json())
        .then((data) => {
          console.log("produk: ", data);

          const daftarProduk = document.querySelector(".card-produk-pembelian");
          daftarProduk.innerHTML = ""; // clear existing cards

          // buat card untuk produk snack
          data.forEach((item) => {
            const harga = item.harga;
            const formattedHarga = `Rp${harga.toLocaleString("id-ID")}`;
            const card = document.createElement("div");
            card.className = "card col-3 m-2";
            card.innerHTML = `
            <div
                    class="card-img d-flex justify-content-center align-items-center m-1"
                  >
                    <img
                      src="/image/minyak-rambut.png"
                      class="card-img-top"
                      alt="Nama Produk"
                    />
                  </div>
                  <div class="card-body">
                    <h6 class="card-title text-center fw-bold">${item.nama_produk}</h6>
                    <p class="card-text text-center">${formattedHarga}</p>
                    <p class="card-text text-center">Stok: ${item.stok}</p>
                    <div class="d-flex justify-content-center">
                      <button type="button" class="btn btn-success m-1" data-bs-toggle="modal" data-bs-target="#updateStockModal">
                        <i class="bi bi-plus-lg"></i>
                      </button>

                    </div>
                  </div>
            `;

            daftarProduk.append(card);
          });
        });

      document
        .getElementById("saveChangesButton")
        .addEventListener("click", () => {
          const form = document.getElementById("tambahJenisProdukForm");
          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());

          fetch("http://localhost:3000/web/newJenisProduk", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          })
            .then((response) => {
              if (!response.ok) {
                return response.json().then((error) => {
                  throw error;
                });
              }
              return response.json();
            })
            .then((result) => {
              console.log("Success:", result);
              // Handle the successful response here
              alert("Data berhasil ditambahkan");

              // Menutup modal setelah sukses
              const modalElement = document.getElementById("exampleModal");
              const modalInstance = bootstrap.Modal.getInstance(modalElement);
              modalInstance.hide();

              // Initial load
              loadProduk();
            })
            .catch((error) => {
              console.error("Error:", error);
              // Handle the error response here
            });
        });

      // // Ambil modal dan form elemen
      // const updateStockModal = document.getElementById("updateStockModal");
      // const updateStockForm = document.getElementById("updateStockForm");
      // const saveStockButton = document.getElementById("saveStockButton");

      // // Variabel untuk menyimpan ID produk yang akan diupdate
      // let selectedProductId = null;

      // // Event listener untuk tombol edit (pencil)
      // document.querySelectorAll(".update-stok").forEach((button) => {
      //   button.addEventListener("click", (event) => {
      //     selectedProductId = event.currentTarget.getAttribute("data-id");
      //     console.log("ID Produk yang dipilih: ", selectedProductId); // Debugging
      //   });
      // });

      // // Event listener untuk tombol simpan stok
      // saveStockButton.addEventListener("click", async () => {
      //   const stockInput = document.getElementById("stock");
      //   const newStock = stockInput.value;

      //   console.log("Nilai stok baru: ", newStock); // Debugging
      //   console.log("Nilai Id: ", selectedProductId); // Debugging

      //   if (!selectedProductId || !newStock) {
      //     alert("Please select a product and enter a new stock quantity.");
      //     return;
      //   }

      //   try {
      //     const response = await fetch("http://localhost:3000/web/updateStok", {
      //       method: "PUT",
      //       headers: {
      //         "Content-Type": "application/json",
      //       },
      //       body: JSON.stringify({
      //         stok: newStock,
      //         id_produk: selectedProductId,
      //       }),
      //     });

      //     if (!response.ok) {
      //       const error = await response.json();
      //       throw new Error(error.message);
      //     }

      //     const result = await response.json();
      //     console.log("Stock updated:", result);
      //     alert("Stock updated successfully");

      //     // Tutup modal
      //     const modalInstance = bootstrap.Modal.getInstance(updateStockModal);
      //     modalInstance.hide();

      //     // Refresh data produk
      //     loadProduk(); // Pastikan loadProduk adalah fungsi yang memuat ulang daftar produk
      //   } catch (error) {
      //     console.error("Error updating stock:", error);
      //     alert("Failed to update stock");
      //   }
      // });

      document.addEventListener("DOMContentLoaded", () => {
        // Ambil modal dan form elemen
        const updateStockModal = document.getElementById("updateStockModal");
        const saveStockButton = document.getElementById("saveStockButton");

        // Variabel untuk menyimpan ID produk yang akan diupdate
        let selectedProductId = null;

        // Event delegation untuk menangani tombol edit (pencil)
        document.addEventListener("click", (event) => {
          const button = event.target.closest(".update-stok");
          if (button) {
            selectedProductId = button.getAttribute("data-id");
            console.log("ID Produk yang dipilih: ", selectedProductId); // Debugging
          }
        });

        // Event listener untuk tombol simpan stok
        saveStockButton.addEventListener("click", async () => {
          const stockInput = document.getElementById("stock");
          const newStock = stockInput.value;

          console.log("Nilai stok baru: ", newStock); // Debugging
          console.log("Nilai Id: ", selectedProductId); // Debugging

          if (!selectedProductId || !newStock) {
            alert("Please select a product and enter a new stock quantity.");
            return;
          }

          try {
            const response = await fetch(
              "http://localhost:3000/web/updateStok",
              {
                method: "PUT",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  stok: newStock,
                  id_produk: selectedProductId,
                }),
              }
            );

            if (!response.ok) {
              const error = await response.json();
              throw new Error(error.message);
            }

            const result = await response.json();
            console.log("Stock updated:", result);
            alert("Stock updated successfully");

            // Tutup modal
            const modalInstance = bootstrap.Modal.getInstance(updateStockModal);
            modalInstance.hide();

            // Refresh data produk
            loadProduk(); // Pastikan loadProduk adalah fungsi yang memuat ulang daftar produk
          } catch (error) {
            console.error("Error updating stock:", error);
            alert("Failed to update stock");
          }
        });
      });
    </script>
  </body>
</html>
